<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Road Hazard Detector - Team-GPT</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-dark: #0a192f;
            --primary: #112240;
            --primary-light: #233554;
            --secondary: #64ffda;
            --secondary-light: #8affdf;
            --text-primary: #e6f1ff;
            --text-secondary: #a8b2d1;
            --text-muted: #8892b0;
            --danger: #ff5c5c;
            --warning: #ffbd4a;
            --success: #4caf50;
            --info: #4dabf7;
            --card-bg: rgba(17, 34, 64, 0.7);
            --card-border: rgba(100, 255, 218, 0.1);
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            --radius: 12px;
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, var(--primary-dark) 0%, var(--primary) 100%);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
            overflow-x: hidden;
        }

        .app-container {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar Navigation */
        .sidebar {
            width: 280px;
            background: var(--primary);
            padding: 30px 20px;
            display: flex;
            flex-direction: column;
            box-shadow: var(--shadow);
            z-index: 10;
            transition: var(--transition);
        }

        .logo {
            display: flex;
            align-items: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--primary-light);
        }

        .logo-icon {
            font-size: 28px;
            color: var(--secondary);
            margin-right: 12px;
        }

        .logo-text {
            font-size: 22px;
            font-weight: 700;
            background: linear-gradient(90deg, var(--secondary), var(--secondary-light));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .nav-menu {
            list-style: none;
            flex-grow: 1;
        }

        .nav-item {
            margin-bottom: 10px;
            position: relative;
        }

        .nav-link {
            display: flex;
            align-items: center;
            padding: 14px 16px;
            color: var(--text-secondary);
            text-decoration: none;
            border-radius: var(--radius);
            transition: var(--transition);
        }

        .nav-link i {
            margin-right: 12px;
            font-size: 18px;
            width: 24px;
            text-align: center;
        }

        .nav-link:hover, .nav-link.active {
            background: var(--primary-light);
            color: var(--text-primary);
        }

        .nav-link.active {
            color: var(--secondary);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .notification-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: var(--danger);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .user-profile {
            display: flex;
            align-items: center;
            padding: 16px 12px;
            border-top: 1px solid var(--primary-light);
            margin-top: 20px;
            position: relative;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
            color: var(--primary-dark);
            font-weight: bold;
        }

        .user-info {
            flex-grow: 1;
        }

        .user-name {
            font-weight: 600;
            font-size: 14px;
        }

        .user-role {
            font-size: 12px;
            color: var(--text-muted);
        }

        .user-switch {
            background: var(--primary-light);
            border: none;
            color: var(--text-secondary);
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .user-switch:hover {
            background: var(--secondary);
            color: var(--primary-dark);
        }

        /* Main Content */
        .main-content {
            flex-grow: 1;
            padding: 30px;
            overflow-y: auto;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .page-title {
            font-size: 28px;
            font-weight: 700;
        }

        .page-subtitle {
            color: var(--text-muted);
            margin-top: 8px;
        }

        .header-actions {
            display: flex;
            gap: 15px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: var(--radius);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        .btn i {
            margin-right: 8px;
        }

        .btn-primary {
            background: var(--secondary);
            color: var(--primary-dark);
        }

        .btn-primary:hover {
            background: var(--secondary-light);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(100, 255, 218, 0.3);
        }

        .btn-secondary {
            background: var(--primary-light);
            color: var(--text-primary);
        }

        .btn-secondary:hover {
            background: rgba(35, 53, 84, 0.8);
            transform: translateY(-2px);
        }

        /* Cards */
        .card {
            background: var(--card-bg);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            margin-bottom: 30px;
            overflow: hidden;
            border: 1px solid var(--card-border);
            transition: var(--transition);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.4);
        }

        .card-header {
            padding: 20px 30px;
            border-bottom: 1px solid var(--card-border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-title {
            font-size: 20px;
            font-weight: 600;
            display: flex;
            align-items: center;
        }

        .card-title i {
            margin-right: 10px;
            color: var(--secondary);
        }

        .card-body {
            padding: 30px;
        }

        /* Dashboard Stats */
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: var(--card-bg);
            border-radius: var(--radius);
            padding: 25px;
            display: flex;
            align-items: center;
            box-shadow: var(--shadow);
            border: 1px solid var(--card-border);
            transition: var(--transition);
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.4);
        }

        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 20px;
            font-size: 24px;
        }

        .stat-icon.high {
            background: rgba(255, 92, 92, 0.2);
            color: var(--danger);
        }

        .stat-icon.medium {
            background: rgba(255, 189, 74, 0.2);
            color: var(--warning);
        }

        .stat-icon.low {
            background: rgba(76, 175, 80, 0.2);
            color: var(--success);
        }

        .stat-info {
            flex-grow: 1;
        }

        .stat-value {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .stat-label {
            color: var(--text-muted);
            font-size: 14px;
        }

        /* Upload Section */
        .upload-area {
            border: 2px dashed var(--primary-light);
            border-radius: var(--radius);
            padding: 50px 30px;
            text-align: center;
            transition: var(--transition);
            cursor: pointer;
            margin-bottom: 20px;
        }

        .upload-area:hover, .upload-area.dragover {
            border-color: var(--secondary);
            background: rgba(100, 255, 218, 0.05);
        }

        .upload-icon {
            font-size: 48px;
            color: var(--text-muted);
            margin-bottom: 20px;
        }

        .upload-text {
            margin-bottom: 25px;
            color: var(--text-secondary);
        }

        .upload-btn {
            background: var(--primary-light);
            color: var(--text-primary);
            padding: 12px 30px;
            border-radius: var(--radius);
            display: inline-flex;
            align-items: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .upload-btn:hover {
            background: var(--secondary);
            color: var(--primary-dark);
        }

        .file-input {
            display: none;
        }

        /* Demo Section */
        .demo-images {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .demo-img-container {
            position: relative;
            border-radius: var(--radius);
            overflow: hidden;
            cursor: pointer;
            transition: var(--transition);
            aspect-ratio: 4/3;
        }

        .demo-img-container:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }

        .demo-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: var(--transition);
        }

        .demo-img-container:hover .demo-img {
            transform: scale(1.05);
        }

        .demo-img-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(to top, rgba(10, 25, 47, 0.9), transparent);
            padding: 15px;
            transform: translateY(10px);
            opacity: 0;
            transition: var(--transition);
        }

        .demo-img-container:hover .demo-img-overlay {
            transform: translateY(0);
            opacity: 1;
        }

        .demo-img-name {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .demo-img-desc {
            font-size: 12px;
            color: var(--text-muted);
        }

        /* Results Section */
        .results-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        .image-comparison {
            position: relative;
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
        }

        .comparison-tabs {
            display: flex;
            background: var(--primary);
            border-bottom: 1px solid var(--card-border);
        }

        .comparison-tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 600;
        }

        .comparison-tab.active {
            background: var(--primary-light);
            color: var(--secondary);
        }

        .comparison-content {
            padding: 20px;
            min-height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .result-image {
            max-width: 100%;
            max-height: 400px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .canvas-overlay {
            position: absolute;
            top: 20px;
            left: 20px;
            width: calc(100% - 40px);
            height: calc(100% - 40px);
            pointer-events: none;
        }

        .detections-list {
            max-height: 500px;
            overflow-y: auto;
        }

        .detection-category {
            margin-bottom: 25px;
        }

        .category-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background: var(--primary);
            border-radius: var(--radius);
            margin-bottom: 15px;
            cursor: pointer;
            transition: var(--transition);
        }

        .category-header:hover {
            background: var(--primary-light);
        }

        .category-title {
            display: flex;
            align-items: center;
            font-weight: 600;
        }

        .category-count {
            background: var(--primary-light);
            color: var(--secondary);
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            margin-left: 10px;
        }

        .detection-items {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
        }

        .detection-item {
            background: var(--primary);
            border-radius: var(--radius);
            padding: 15px;
            border-left: 4px solid;
            transition: var(--transition);
        }

        .detection-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .detection-item.high {
            border-left-color: var(--danger);
        }

        .detection-item.medium {
            border-left-color: var(--warning);
        }

        .detection-item.low {
            border-left-color: var(--success);
        }

        .detection-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .detection-type {
            font-weight: 600;
            font-size: 14px;
        }

        .detection-confidence {
            background: var(--primary-light);
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }

        .detection-bbox {
            font-size: 12px;
            color: var(--text-muted);
            margin-bottom: 8px;
        }

        .detection-severity {
            display: inline-flex;
            align-items: center;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }

        .severity-high {
            background: rgba(255, 92, 92, 0.2);
            color: var(--danger);
        }

        .severity-medium {
            background: rgba(255, 189, 74, 0.2);
            color: var(--warning);
        }

        .severity-low {
            background: rgba(76, 175, 80, 0.2);
            color: var(--success);
        }

        /* Loading */
        .loading {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(100, 255, 218, 0.2);
            border-top: 4px solid var(--secondary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            color: var(--text-muted);
            font-size: 16px;
        }

        /* Alert Messages */
        .alert {
            padding: 15px 20px;
            border-radius: var(--radius);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
        }

        .alert i {
            margin-right: 10px;
            font-size: 18px;
        }

        .alert-error {
            background: rgba(255, 92, 92, 0.1);
            border-left: 4px solid var(--danger);
            color: var(--danger);
        }

        .alert-success {
            background: rgba(76, 175, 80, 0.1);
            border-left: 4px solid var(--success);
            color: var(--success);
        }

        /* Report Section */
        .report-form {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-secondary);
        }

        .form-control {
            width: 100%;
            padding: 12px 16px;
            background: var(--primary);
            border: 1px solid var(--primary-light);
            border-radius: var(--radius);
            color: var(--text-primary);
            transition: var(--transition);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--secondary);
            box-shadow: 0 0 0 2px rgba(100, 255, 218, 0.2);
        }

        textarea.form-control {
            min-height: 120px;
            resize: vertical;
        }

        /* Map Visualization */
        .map-container {
            height: 300px;
            background: var(--primary);
            border-radius: var(--radius);
            overflow: hidden;
            margin-bottom: 30px;
            position: relative;
        }

        .map-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(10, 25, 47, 0.8) 0%, rgba(17, 34, 64, 0.9) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }

        .map-placeholder {
            text-align: center;
            padding: 30px;
        }

        .map-icon {
            font-size: 48px;
            color: var(--text-muted);
            margin-bottom: 15px;
        }

        /* History Section */
        .history-filters {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .history-table {
            width: 100%;
            border-collapse: collapse;
        }

        .history-table th,
        .history-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid var(--card-border);
        }

        .history-table th {
            background: var(--primary);
            color: var(--text-secondary);
            font-weight: 600;
        }

        .history-table tr:hover {
            background: rgba(100, 255, 218, 0.05);
        }

        /* Analytics Section */
        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .chart-container {
            background: var(--card-bg);
            border-radius: var(--radius);
            padding: 25px;
            box-shadow: var(--shadow);
            border: 1px solid var(--card-border);
        }

        .chart-title {
            font-size: 18px;
            margin-bottom: 20px;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
        }

        .chart-title i {
            margin-right: 10px;
            color: var(--secondary);
        }

        .chart-placeholder {
            height: 200px;
            background: var(--primary);
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-muted);
            font-size: 14px;
        }

        /* Settings Section */
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
        }

        .settings-group {
            background: var(--card-bg);
            border-radius: var(--radius);
            padding: 25px;
            box-shadow: var(--shadow);
            border: 1px solid var(--card-border);
        }

        .settings-title {
            font-size: 18px;
            margin-bottom: 20px;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
        }

        .settings-title i {
            margin-right: 10px;
            color: var(--secondary);
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--primary-light);
            transition: .4s;
            border-radius: 24px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: var(--text-primary);
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .toggle-slider {
            background-color: var(--secondary);
        }

        input:checked + .toggle-slider:before {
            transform: translateX(26px);
        }

        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid var(--card-border);
        }

        .setting-item:last-child {
            border-bottom: none;
        }

        .setting-label {
            font-weight: 600;
        }

        .setting-description {
            font-size: 14px;
            color: var(--text-muted);
            margin-top: 5px;
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .results-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 992px) {
            .app-container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                padding: 20px;
            }
            
            .nav-menu {
                display: flex;
                overflow-x: auto;
                margin-bottom: 20px;
            }
            
            .nav-item {
                margin-bottom: 0;
                margin-right: 10px;
            }
            
            .nav-link {
                white-space: nowrap;
            }
        }

        @media (max-width: 768px) {
            .stats-container {
                grid-template-columns: 1fr;
            }
            
            .report-form {
                grid-template-columns: 1fr;
            }
            
            .demo-images {
                grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            }
            
            .history-table {
                display: block;
                overflow-x: auto;
            }
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease forwards;
        }

        /* Advanced UI Elements */
        .progress-bar {
            height: 6px;
            background: var(--primary-light);
            border-radius: 3px;
            overflow: hidden;
            margin-top: 10px;
        }

        .progress-fill {
            height: 100%;
            background: var(--secondary);
            transition: width 0.3s ease;
        }

        .stat-trend {
            font-size: 12px;
            display: flex;
            align-items: center;
            margin-top: 5px;
        }

        .trend-up {
            color: var(--success);
        }

        .trend-down {
            color: var(--danger);
        }

        .hazard-map {
            width: 100%;
            height: 100%;
            background: var(--primary);
            border-radius: var(--radius);
            position: relative;
            overflow: hidden;
        }

        .map-point {
            position: absolute;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            transform: translate(-50%, -50%);
        }

        .point-high {
            background: var(--danger);
            box-shadow: 0 0 10px var(--danger);
        }

        .point-medium {
            background: var(--warning);
            box-shadow: 0 0 10px var(--warning);
        }

        .point-low {
            background: var(--success);
            box-shadow: 0 0 10px var(--success);
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Sidebar Navigation -->
        <div class="sidebar">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-road"></i>
                </div>
                <div class="logo-text">Team-GPT</div>
            </div>
            
            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="#" class="nav-link" data-target="dashboard">
                        <i class="fas fa-chart-line"></i>
                        <span>Dashboard</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link active" data-target="detection">
                        <i class="fas fa-camera"></i>
                        <span>Detection</span>
                        <span class="notification-badge">3</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-target="history">
                        <i class="fas fa-history"></i>
                        <span>History</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-target="analytics">
                        <i class="fas fa-chart-bar"></i>
                        <span>Analytics</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-target="settings">
                        <i class="fas fa-cog"></i>
                        <span>Settings</span>
                    </a>
                </li>
            </ul>
            
            <div class="user-profile">
                <div class="user-avatar">U1</div>
                <div class="user-info">
                    <div class="user-name">User 1</div>
                    <div class="user-role">Road Safety Analyst</div>
                </div>
                <button class="user-switch" id="userSwitch">
                    <i class="fas fa-sync-alt"></i>
                </button>
            </div>
        </div>
        
        <!-- Main Content -->
        <div class="main-content">
            <div class="header">
                <div>
                    <h1 class="page-title">Road Hazard Detection</h1>
                    <p class="page-subtitle">AI-powered detection of road hazards with privacy protection</p>
                </div>
                <div class="header-actions">
                    <button class="btn btn-secondary">
                        <i class="fas fa-download"></i>
                        Export Report
                    </button>
                    <button class="btn btn-primary" id="newDetectionBtn">
                        <i class="fas fa-plus"></i>
                        New Detection
                    </button>
                </div>
            </div>
            
            <!-- Dashboard Section -->
            <section id="dashboard" class="content-section">
                <div class="stats-container">
                    <div class="stat-card">
                        <div class="stat-icon high">
                            <i class="fas fa-exclamation-triangle"></i>
                        </div>
                        <div class="stat-info">
                            <div class="stat-value">24</div>
                            <div class="stat-label">High Severity Hazards</div>
                            <div class="stat-trend trend-up">
                                <i class="fas fa-arrow-up"></i> 12% from last week
                            </div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon medium">
                            <i class="fas fa-road"></i>
                        </div>
                        <div class="stat-info">
                            <div class="stat-value">42</div>
                            <div class="stat-label">Potholes Detected</div>
                            <div class="stat-trend trend-down">
                                <i class="fas fa-arrow-down"></i> 5% from last week
                            </div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon low">
                            <i class="fas fa-car"></i>
                        </div>
                        <div class="stat-info">
                            <div class="stat-value">18</div>
                            <div class="stat-label">Stalled Vehicles</div>
                            <div class="stat-trend trend-up">
                                <i class="fas fa-arrow-up"></i> 8% from last week
                            </div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <div class="stat-info">
                            <div class="stat-value">92%</div>
                            <div class="stat-label">Detection Accuracy</div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 92%"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">
                            <i class="fas fa-map-marked-alt"></i>
                            Hazard Map Overview
                        </h2>
                        <button class="btn btn-secondary">
                            <i class="fas fa-filter"></i>
                            Filter
                        </button>
                    </div>
                    <div class="card-body">
                        <div class="hazard-map" id="hazardMap">
                            <!-- Hazard points will be added dynamically -->
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">
                            <i class="fas fa-history"></i>
                            Recent Detections
                        </h2>
                        <button class="btn btn-secondary">
                            <i class="fas fa-sync-alt"></i>
                            Refresh
                        </button>
                    </div>
                    <div class="card-body">
                        <div class="detections-list" id="recentDetections">
                            <!-- Recent detections will be populated here -->
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Detection Section -->
            <section id="detection" class="content-section active">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">
                            <i class="fas fa-upload"></i>
                            Upload Road Image
                        </h2>
                        <div class="mode-switch">
                            <button class="btn btn-secondary active" id="uploadMode">
                                <i class="fas fa-upload"></i>
                                Upload Image
                            </button>
                            <button class="btn btn-secondary" id="demoMode">
                                <i class="fas fa-images"></i>
                                Demo Images
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div id="uploadSection" class="upload-section">
                            <div class="upload-area" id="dropZone">
                                <div class="upload-icon">
                                    <i class="fas fa-cloud-upload-alt"></i>
                                </div>
                                <h3 class="upload-text">Drag & Drop your road image here</h3>
                                <p style="color: var(--text-muted); margin-bottom: 20px;">or</p>
                                <label for="fileInput" class="upload-btn">
                                    <i class="fas fa-folder-open"></i>
                                    Browse Files
                                </label>
                                <input type="file" id="fileInput" class="file-input" accept="image/*">
                            </div>
                            <div class="loading" id="loading" style="display: none;">
                                <div class="spinner"></div>
                                <div class="loading-text">Processing image...</div>
                            </div>
                            <div class="alert alert-error" id="error" style="display: none;">
                                <i class="fas fa-exclamation-circle"></i>
                                <span id="errorText"></span>
                            </div>
                        </div>
                        
                        <div id="demoSection" class="demo-section" style="display: none;">
                            <div class="demo-path-input" style="margin-bottom: 25px;">
                                <div class="form-group">
                                    <label class="form-label">Demo Images Path (Optional)</label>
                                    <div style="display: flex; gap: 10px;">
                                        <input type="text" id="demoPathInput" class="form-control" placeholder="Enter path to demo images">
                                        <button class="btn btn-primary" id="loadDemoBtn">
                                            <i class="fas fa-folder-open"></i>
                                            Load
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <h3 style="margin-bottom: 20px; color: var(--text-secondary);">Select Demo Image</h3>
                            <div class="demo-images" id="demoImages">
                                <!-- Demo images will be populated here -->
                            </div>
                            
                            <div style="text-align: center; margin-top: 25px;">
                                <button class="btn btn-primary" id="processDemoBtn">
                                    <i class="fas fa-play"></i>
                                    Process All Demo Images
                                </button>
                            </div>
                            
                            <div class="loading" id="demoLoading" style="display: none;">
                                <div class="spinner"></div>
                                <div class="loading-text">Processing demo images...</div>
                            </div>
                            <div class="alert alert-error" id="demoError" style="display: none;">
                                <i class="fas fa-exclamation-circle"></i>
                                <span id="demoErrorText"></span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card results" id="results" style="display: none;">
                    <div class="card-header">
                        <h2 class="card-title">
                            <i class="fas fa-search"></i>
                            Detection Results
                        </h2>
                        <button class="btn btn-primary" id="saveReportBtn">
                            <i class="fas fa-save"></i>
                            Save Report
                        </button>
                    </div>
                    <div class="card-body">
                        <div class="results-grid">
                            <div class="image-comparison">
                                <div class="comparison-tabs">
                                    <div class="comparison-tab active" data-tab="original">Original</div>
                                    <div class="comparison-tab" data-tab="processed">Processed</div>
                                    <div class="comparison-tab" data-tab="overlay">Overlay</div>
                                </div>
                                <div class="comparison-content">
                                    <img id="resultImage" class="result-image" src="" alt="Detection Result">
                                    <canvas id="overlayCanvas" class="canvas-overlay"></canvas>
                                </div>
                            </div>
                            
                            <div class="detections-list">
                                <h3 style="margin-bottom: 20px; color: var(--text-secondary);">Detected Hazards</h3>
                                <div id="detections">
                                    <!-- Detection items will be populated here -->
                                </div>
                            </div>
                        </div>
                        
                        <div class="report-section" style="margin-top: 30px;">
                            <h3 style="margin-bottom: 20px; color: var(--text-secondary);">Report Hazards</h3>
                            <div class="report-form">
                                <div class="form-group">
                                    <label class="form-label">Location</label>
                                    <input type="text" class="form-control" id="reportLocation" placeholder="Enter hazard location">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Priority</label>
                                    <select class="form-control" id="reportPriority">
                                        <option value="low">Low</option>
                                        <option value="medium">Medium</option>
                                        <option value="high">High</option>
                                    </select>
                                </div>
                                <div class="form-group full-width">
                                    <label class="form-label">Additional Notes</label>
                                    <textarea class="form-control" id="reportNotes" placeholder="Add any additional details about the hazards"></textarea>
                                </div>
                            </div>
                            <div style="text-align: right; margin-top: 20px;">
                                <button class="btn btn-primary" id="reportBtn">
                                    <i class="fas fa-paper-plane"></i>
                                    Send Report
                                </button>
                            </div>
                            <div class="alert alert-success" id="successMsg" style="display: none;">
                                <i class="fas fa-check-circle"></i>
                                Report sent successfully!
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- History Section -->
            <section id="history" class="content-section" style="display: none;">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">
                            <i class="fas fa-history"></i>
                            Detection History
                        </h2>
                        <button class="btn btn-secondary">
                            <i class="fas fa-filter"></i>
                            Filter Results
                        </button>
                    </div>
                    <div class="card-body">
                        <div class="history-filters">
                            <div class="filter-group">
                                <label class="form-label">Date Range</label>
                                <select class="form-control">
                                    <option>Last 7 days</option>
                                    <option>Last 30 days</option>
                                    <option>Last 3 months</option>
                                    <option>Custom range</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label class="form-label">Hazard Type</label>
                                <select class="form-control">
                                    <option>All types</option>
                                    <option>Potholes</option>
                                    <option>Cracks</option>
                                    <option>Stalled Vehicles</option>
                                    <option>Debris</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label class="form-label">Severity</label>
                                <select class="form-control">
                                    <option>All severities</option>
                                    <option>High</option>
                                    <option>Medium</option>
                                    <option>Low</option>
                                </select>
                            </div>
                        </div>
                        
                        <table class="history-table">
                            <thead>
                                <tr>
                                    <th>Date & Time</th>
                                    <th>Image</th>
                                    <th>Hazard Type</th>
                                    <th>Severity</th>
                                    <th>Confidence</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>2023-10-15 14:32</td>
                                    <td>road_image_001.jpg</td>
                                    <td>Potholes</td>
                                    <td><span class="detection-severity severity-high">HIGH</span></td>
                                    <td>92%</td>
                                    <td>
                                        <button class="btn btn-secondary" style="padding: 5px 10px; font-size: 12px;">
                                            <i class="fas fa-eye"></i> View
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>2023-10-14 11:15</td>
                                    <td>road_image_002.jpg</td>
                                    <td>Cracks</td>
                                    <td><span class="detection-severity severity-medium">MEDIUM</span></td>
                                    <td>78%</td>
                                    <td>
                                        <button class="btn btn-secondary" style="padding: 5px 10px; font-size: 12px;">
                                            <i class="fas fa-eye"></i> View
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>2023-10-13 09:45</td>
                                    <td>road_image_003.jpg</td>
                                    <td>Stalled Vehicle</td>
                                    <td><span class="detection-severity severity-low">LOW</span></td>
                                    <td>65%</td>
                                    <td>
                                        <button class="btn btn-secondary" style="padding: 5px 10px; font-size: 12px;">
                                            <i class="fas fa-eye"></i> View
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>2023-10-12 16:20</td>
                                    <td>road_image_004.jpg</td>
                                    <td>Debris</td>
                                    <td><span class="detection-severity severity-medium">MEDIUM</span></td>
                                    <td>81%</td>
                                    <td>
                                        <button class="btn btn-secondary" style="padding: 5px 10px; font-size: 12px;">
                                            <i class="fas fa-eye"></i> View
                                        </button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>
            
            <!-- Analytics Section -->
            <section id="analytics" class="content-section" style="display: none;">
                <div class="analytics-grid">
                    <div class="chart-container">
                        <h3 class="chart-title">
                            <i class="fas fa-chart-pie"></i>
                            Hazard Distribution
                        </h3>
                        <div class="chart-placeholder">
                            Pie Chart: Hazard Types Distribution
                        </div>
                    </div>
                    <div class="chart-container">
                        <h3 class="chart-title">
                            <i class="fas fa-chart-line"></i>
                            Detection Trends
                        </h3>
                        <div class="chart-placeholder">
                            Line Chart: Detection Trends Over Time
                        </div>
                    </div>
                    <div class="chart-container">
                        <h3 class="chart-title">
                            <i class="fas fa-map-marker-alt"></i>
                            Geographic Distribution
                        </h3>
                        <div class="chart-placeholder">
                            Map: Hazard Locations
                        </div>
                    </div>
                    <div class="chart-container">
                        <h3 class="chart-title">
                            <i class="fas fa-tachometer-alt"></i>
                            System Performance
                        </h3>
                        <div class="chart-placeholder">
                            Performance Metrics Over Time
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">
                            <i class="fas fa-table"></i>
                            Analytics Summary
                        </h2>
                        <button class="btn btn-primary">
                            <i class="fas fa-download"></i>
                            Export Data
                        </button>
                    </div>
                    <div class="card-body">
                        <div class="stats-container">
                            <div class="stat-card">
                                <div class="stat-info">
                                    <div class="stat-value">1,247</div>
                                    <div class="stat-label">Total Hazards Detected</div>
                                    <div class="stat-trend trend-up">
                                        <i class="fas fa-arrow-up"></i> 18% from last month
                                    </div>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-info">
                                    <div class="stat-value">84%</div>
                                    <div class="stat-label">Average Detection Accuracy</div>
                                    <div class="progress-bar">
                                        <div class="progress-fill" style="width: 84%"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-info">
                                    <div class="stat-value">92%</div>
                                    <div class="stat-label">System Uptime</div>
                                    <div class="stat-trend trend-up">
                                        <i class="fas fa-arrow-up"></i> 3% from last quarter
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Settings Section -->
            <section id="settings" class="content-section" style="display: none;">
                <div class="settings-grid">
                    <div class="settings-group">
                        <h3 class="settings-title">
                            <i class="fas fa-user-cog"></i>
                            User Preferences
                        </h3>
                        <div class="setting-item">
                            <div>
                                <div class="setting-label">Dark Mode</div>
                                <div class="setting-description">Use dark theme for the application</div>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                        <div class="setting-item">
                            <div>
                                <div class="setting-label">Notifications</div>
                                <div class="setting-description">Receive alerts for new detections</div>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                        <div class="setting-item">
                            <div>
                                <div class="setting-label">Auto-save Reports</div>
                                <div class="setting-description">Automatically save detection reports</div>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="settings-group">
                        <h3 class="settings-title">
                            <i class="fas fa-cogs"></i>
                            Detection Settings
                        </h3>
                        <div class="setting-item">
                            <div>
                                <div class="setting-label">Confidence Threshold</div>
                                <div class="setting-description">Minimum confidence for hazard detection</div>
                            </div>
                            <select class="form-control" style="width: 120px;">
                                <option>Low (50%)</option>
                                <option selected>Medium (70%)</option>
                                <option>High (85%)</option>
                            </select>
                        </div>
                        <div class="setting-item">
                            <div>
                                <div class="setting-label">Privacy Mode</div>
                                <div class="setting-description">Blur sensitive information in images</div>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                        <div class="setting-item">
                            <div>
                                <div class="setting-label">Auto-process Images</div>
                                <div class="setting-description">Process images immediately after upload</div>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="settings-group">
                        <h3 class="settings-title">
                            <i class="fas fa-shield-alt"></i>
                            Security & Privacy
                        </h3>
                        <div class="setting-item">
                            <div>
                                <div class="setting-label">Data Encryption</div>
                                <div class="setting-description">Encrypt all stored data</div>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                        <div class="setting-item">
                            <div>
                                <div class="setting-label">Auto-logout</div>
                                <div class="setting-description">Automatically logout after 30 minutes</div>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                        <div class="setting-item">
                            <div>
                                <div class="setting-label">Audit Logging</div>
                                <div class="setting-description">Keep logs of all user activities</div>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="settings-group">
                        <h3 class="settings-title">
                            <i class="fas fa-database"></i>
                            Data Management
                        </h3>
                        <div class="setting-item">
                            <div>
                                <div class="setting-label">Retention Period</div>
                                <div class="setting-description">How long to keep detection data</div>
                            </div>
                            <select class="form-control" style="width: 140px;">
                                <option>30 days</option>
                                <option selected>90 days</option>
                                <option>1 year</option>
                                <option>Indefinitely</option>
                            </select>
                        </div>
                        <div class="setting-item">
                            <div>
                                <div class="setting-label">Backup Frequency</div>
                                <div class="setting-description">How often to backup data</div>
                            </div>
                            <select class="form-control" style="width: 140px;">
                                <option>Daily</option>
                                <option selected>Weekly</option>
                                <option>Monthly</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <button class="btn btn-primary" style="width: 100%; margin-top: 15px;">
                                <i class="fas fa-save"></i>
                                Save All Settings
                            </button>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </div>

    <script>
        // DOM Elements
        const fileInput = document.getElementById('fileInput');
        const dropZone = document.getElementById('dropZone');
        const loading = document.getElementById('loading');
        const error = document.getElementById('error');
        const results = document.getElementById('results');
        const resultImage = document.getElementById('resultImage');
        const overlayCanvas = document.getElementById('overlayCanvas');
        const detectionsDiv = document.getElementById('detections');
        const reportBtn = document.getElementById('reportBtn');
        const reportNotes = document.getElementById('reportNotes');
        const reportLocation = document.getElementById('reportLocation');
        const reportPriority = document.getElementById('reportPriority');
        const uploadMode = document.getElementById('uploadMode');
        const demoMode = document.getElementById('demoMode');
        const uploadSection = document.getElementById('uploadSection');
        const demoSection = document.getElementById('demoSection');
        const demoImages = document.getElementById('demoImages');
        const processDemoBtn = document.getElementById('processDemoBtn');
        const demoLoading = document.getElementById('demoLoading');
        const demoError = document.getElementById('demoError');
        const comparisonTabs = document.querySelectorAll('.comparison-tab');
        const successMsg = document.getElementById('successMsg');
        const demoPathInput = document.getElementById('demoPathInput');
        const loadDemoBtn = document.getElementById('loadDemoBtn');
        const saveReportBtn = document.getElementById('saveReportBtn');
        const navLinks = document.querySelectorAll('.nav-link');
        const contentSections = document.querySelectorAll('.content-section');
        const userSwitch = document.getElementById('userSwitch');
        const userAvatar = document.querySelector('.user-avatar');
        const userName = document.querySelector('.user-name');
        const newDetectionBtn = document.getElementById('newDetectionBtn');
        const hazardMap = document.getElementById('hazardMap');
        const recentDetections = document.getElementById('recentDetections');

        // State variables
        let currentDetections = {};
        let demoImagesData = [];
        let currentImageData = null;
        let currentProcessedImageData = null;
        let currentUser = 'User 1';
        let currentDetectionMode = 'upload';

        // Event Listeners
        document.addEventListener('DOMContentLoaded', initializeApp);
        fileInput.addEventListener('change', handleFileSelect);
        dropZone.addEventListener('click', () => fileInput.click());
        dropZone.addEventListener('dragover', handleDragOver);
        dropZone.addEventListener('drop', handleDrop);
        reportBtn.addEventListener('click', sendReport);
        saveReportBtn.addEventListener('click', saveReport);
        uploadMode.addEventListener('click', () => switchMode('upload'));
        demoMode.addEventListener('click', () => switchMode('demo'));
        processDemoBtn.addEventListener('click', processAllDemoImages);
        loadDemoBtn.addEventListener('click', () => loadDemoImages(demoPathInput.value.trim()));
        comparisonTabs.forEach(tab => {
            tab.addEventListener('click', () => switchComparisonTab(tab.dataset.tab));
        });
        navLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                switchNavigation(link.dataset.target);
            });
        });
        userSwitch.addEventListener('click', switchUser);
        newDetectionBtn.addEventListener('click', () => {
            switchNavigation('detection');
            switchMode('upload');
            hideResults();
        });

        // Initialize the application
        function initializeApp() {
            // Set Detection as default page
            switchNavigation('detection');
            
            // Load demo images on app start
            loadDemoImages();
            
            // Add some sample recent detections to dashboard
            populateRecentDetections();
            
            // Initialize hazard map
            initializeHazardMap();
        }

        // Navigation switching
        function switchNavigation(target) {
            // Update active nav link
            navLinks.forEach(link => {
                link.classList.toggle('active', link.dataset.target === target);
                // Remove notification badge when clicking on detection
                if (link.dataset.target === target && target === 'detection') {
                    const badge = link.querySelector('.notification-badge');
                    if (badge) badge.remove();
                }
            });
            
            // Show/hide content sections
            contentSections.forEach(section => {
                section.style.display = section.id === target ? 'block' : 'none';
            });
        }

        // User switching functionality
        function switchUser() {
            if (currentUser === 'User 1') {
                currentUser = 'User 2';
                userAvatar.textContent = 'U2';
                userName.textContent = 'User 2';
                userAvatar.style.background = '#ff6b6b';
            } else {
                currentUser = 'User 1';
                userAvatar.textContent = 'U1';
                userName.textContent = 'User 1';
                userAvatar.style.background = 'var(--secondary)';
            }
            
            // Show notification
            showSuccess(`Switched to ${currentUser}`);
        }

        // Mode switching (Upload/Demo)
        function switchMode(mode) {
            currentDetectionMode = mode;
            uploadMode.classList.toggle('active', mode === 'upload');
            demoMode.classList.toggle('active', mode === 'demo');
            uploadSection.style.display = mode === 'upload' ? 'block' : 'none';
            demoSection.style.display = mode === 'demo' ? 'block' : 'none';
            hideResults();
            hideError();
            hideDemoError();
            if (mode === 'demo') {
                loadDemoImages();
            }
        }

        // Drag and drop handlers
        function handleDragOver(e) {
            e.preventDefault();
            dropZone.classList.add('dragover');
        }

        function handleDrop(e) {
            e.preventDefault();
            dropZone.classList.remove('dragover');
            
            if (e.dataTransfer.files.length) {
                fileInput.files = e.dataTransfer.files;
                handleFileSelect(e);
            }
        }

        // File selection handler
        function handleFileSelect(event) {
            const file = event.dataTransfer ? event.dataTransfer.files[0] : event.target.files[0];
            if (!file) return;
            
            if (!file.type.startsWith('image/')) {
                showError('Please select a valid image file (JPEG, PNG, etc.).');
                return;
            }
            
            // Preview the image
            const reader = new FileReader();
            reader.onload = function(e) {
                currentImageData = e.target.result;
                resultImage.src = currentImageData;
            };
            reader.readAsDataURL(file);
            
            uploadImage(file);
        }

        // Upload and process image
        async function uploadImage(file) {
            hideError();
            showLoading();
            hideResults();

            const formData = new FormData();
            formData.append('image', file);

            try {
                const response = await fetch('http://localhost:5000/detect', {
                    method: 'POST',
                    body: formData
                });

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                const data = await response.json();

                if (data.error) {
                    throw new Error(data.error);
                }

                displayResults(data);
            } catch (err) {
                showError(`Detection failed: ${err.message}`);
            } finally {
                hideLoading();
            }
        }

        // Load demo images from backend
        async function loadDemoImages(path = '') {
            try {
                const url = path ? `http://localhost:5000/get_demo_images?path=${encodeURIComponent(path)}` : 'http://localhost:5000/get_demo_images';
                const response = await fetch(url);
                if (!response.ok) throw new Error('Failed to load demo images');
                const data = await response.json();
                demoImagesData = data.demo_images;
                displayDemoImages(data.demo_images);
            } catch (err) {
                showDemoError('Failed to load demo images: ' + err.message);
            }
        }

        // Display demo images in the grid
        function displayDemoImages(images) {
            demoImages.innerHTML = '';
            images.forEach(img => {
                const imgContainer = document.createElement('div');
                imgContainer.className = 'demo-img-container';
                imgContainer.innerHTML = `
                    <img src="data:image/jpeg;base64,${img.data}" class="demo-img" alt="${img.name}">
                    <div class="demo-img-overlay">
                        <div class="demo-img-name">${img.name}</div>
                        <div class="demo-img-desc">${img.description || 'Click to process'}</div>
                    </div>
                `;
                imgContainer.addEventListener('click', () => processDemoImage(img.name));
                demoImages.appendChild(imgContainer);
            });
        }

        // Process a single demo image
        async function processDemoImage(imageName) {
            hideDemoError();
            showDemoLoading();
            hideResults();

            try {
                const response = await fetch('http://localhost:5000/process_demo', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ image_name: imageName })
                });

                if (!response.ok) throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                const data = await response.json();
                if (data.error) throw new Error(data.error);

                // Store the original demo image
                const originalImage = demoImagesData.find(img => img.name === imageName);
                if (originalImage) {
                    currentImageData = `data:image/jpeg;base64,${originalImage.data}`;
                }

                displayResults(data);
            } catch (err) {
                showDemoError('Demo processing failed: ' + err.message);
            } finally {
                hideDemoLoading();
            }
        }

        // Process all demo images
        async function processAllDemoImages() {
            hideDemoError();
            showDemoLoading();
            hideResults();

            const results = [];
            for (const img of demoImagesData) {
                try {
                    const response = await fetch('http://localhost:5000/process_demo', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ image_name: img.name })
                    });
                    if (response.ok) {
                        const data = await response.json();
                        if (!data.error) results.push(data);
                    }
                } catch (err) {
                    console.warn(`Failed to process ${img.name}: ${err.message}`);
                }
            }

            if (results.length > 0) {
                // For simplicity, just display the first result
                const originalImage = demoImagesData.find(img => img.name === results[0].image_name);
                if (originalImage) {
                    currentImageData = `data:image/jpeg;base64,${originalImage.data}`;
                }
                displayResults(results[0]);
            } else {
                showDemoError('No demo images could be processed successfully.');
            }
            hideDemoLoading();
        }

        // Display results from image processing
        function displayResults(data) {
            console.log("Displaying results:", data);
            
            if (!data) {
                showError("No data received from processing");
                return;
            }
            
            currentDetections = data.detections || {};
            
            // Store the processed image data
            currentProcessedImageData = data.processed_image || data.blurred_image;
            
            if (!currentProcessedImageData) {
                showError("No processed image data found in response");
                return;
            }
            
            // Set the processed image for display
            resultImage.src = `data:image/jpeg;base64,${currentProcessedImageData}`;
            
            // Set up the overlay canvas for upload mode
            if (currentDetectionMode === 'upload') {
                const img = new Image();
                img.onload = function() {
                    overlayCanvas.width = img.width;
                    overlayCanvas.height = img.height;
                    
                    const ctx = overlayCanvas.getContext('2d');
                    ctx.clearRect(0, 0, overlayCanvas.width, overlayCanvas.height);
                    
                    // Draw the detections on the overlay
                    drawOverlays(currentDetections);
                };
                img.src = `data:image/jpeg;base64,${currentProcessedImageData}`;
            }
            
            // Display detections
            displayDetections(currentDetections);
            
            // Show results section
            showResults();
            
            // Switch to processed tab by default
            switchComparisonTab('processed');
        }

        // Draw detection overlays on canvas
        function drawOverlays(detections) {
            const canvas = overlayCanvas;
            const ctx = canvas.getContext('2d');
            const img = resultImage;

            // Clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Set up scaling factors
            const scaleX = canvas.width / img.naturalWidth;
            const scaleY = canvas.height / img.naturalHeight;

            // Define colors for different severities
            const colors = { 
                high: '#ff5c5c', 
                medium: '#ffbd4a', 
                low: '#4caf50' 
            };

            // Draw bounding boxes and labels
            Object.values(detections).flat().forEach(det => {
                const [x1, y1, x2, y2] = det.bbox;
                const color = colors[det.severity] || '#ffffff';
                
                // Draw bounding box
                ctx.strokeStyle = color;
                ctx.lineWidth = 3;
                ctx.strokeRect(x1 * scaleX, y1 * scaleY, (x2 - x1) * scaleX, (y2 - y1) * scaleY);
                
                // Draw label background
                const label = `${det.severity.toUpperCase()} ${(det.confidence * 100).toFixed(1)}%`;
                ctx.font = '16px Arial';
                const textWidth = ctx.measureText(label).width;
                
                ctx.fillStyle = color;
                ctx.fillRect(x1 * scaleX, y1 * scaleY - 25, textWidth + 10, 25);
                
                // Draw label text
                ctx.fillStyle = '#ffffff';
                ctx.fillText(label, x1 * scaleX + 5, y1 * scaleY - 7);
            });
        }

        // Display detection details
        function displayDetections(detections) {
            detectionsDiv.innerHTML = '';
            
            const hazardTypes = [
                { key: 'potholes', name: 'Potholes', icon: 'fa-road' },
                { key: 'stalled_vehicles', name: 'Stalled Vehicles', icon: 'fa-car' },
                { key: 'speed_breakers', name: 'Speed Breakers', icon: 'fa-traffic-light' },
                { key: 'manholes', name: 'Manholes', icon: 'fa-circle' },
                { key: 'debris', name: 'Debris', icon: 'fa-trash' }
            ];
            
            hazardTypes.forEach(type => {
                const items = detections[type.key] || [];
                if (items.length > 0) {
                    const categoryDiv = document.createElement('div');
                    categoryDiv.className = 'detection-category';
                    
                    categoryDiv.innerHTML = `
                        <div class="category-header">
                            <div class="category-title">
                                <i class="fas ${type.icon}"></i>
                                <span>${type.name}</span>
                                <span class="category-count">${items.length}</span>
                            </div>
                            <i class="fas fa-chevron-down"></i>
                        </div>
                        <div class="detection-items">
                            ${items.map(item => `
                                <div class="detection-item ${item.severity}">
                                    <div class="detection-header">
                                        <div class="detection-type">${type.name}</div>
                                        <div class="detection-confidence">${(item.confidence * 100).toFixed(1)}%</div>
                                    </div>
                                    <div class="detection-bbox">BBox: [${item.bbox.join(', ')}]</div>
                                    <div class="detection-severity severity-${item.severity}">
                                        ${item.severity.toUpperCase()}
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    `;
                    
                    detectionsDiv.appendChild(categoryDiv);
                    
                    // Add click handler to toggle category
                    const header = categoryDiv.querySelector('.category-header');
                    header.addEventListener('click', () => {
                        const items = categoryDiv.querySelector('.detection-items');
                        const icon = header.querySelector('.fa-chevron-down');
                        items.style.display = items.style.display === 'none' ? 'grid' : 'none';
                        icon.classList.toggle('fa-chevron-down');
                        icon.classList.toggle('fa-chevron-up');
                    });
                }
            });
        }

        // Switch between comparison tabs (Original/Processed/Overlay)
        function switchComparisonTab(tab) {
            comparisonTabs.forEach(t => t.classList.remove('active'));
            document.querySelector(`.comparison-tab[data-tab="${tab}"]`).classList.add('active');
            
            if (currentDetectionMode === 'upload') {
                switch(tab) {
                    case 'original':
                        resultImage.src = currentImageData;
                        overlayCanvas.style.display = 'none';
                        break;
                    case 'processed':
                        resultImage.src = `data:image/jpeg;base64,${currentProcessedImageData}`;
                        overlayCanvas.style.display = 'none';
                        break;
                    case 'overlay':
                        resultImage.src = `data:image/jpeg;base64,${currentProcessedImageData}`;
                        overlayCanvas.style.display = 'block';
                        drawOverlays(currentDetections);
                        break;
                }
            } else {
                // Demo mode - no overlay drawing needed
                switch(tab) {
                    case 'original':
                        resultImage.src = currentImageData;
                        overlayCanvas.style.display = 'none';
                        break;
                    case 'processed':
                        resultImage.src = `data:image/jpeg;base64,${currentProcessedImageData}`;
                        overlayCanvas.style.display = 'none';
                        break;
                    case 'overlay':
                        // In demo mode, the processed image already has boxes
                        resultImage.src = `data:image/jpeg;base64,${currentProcessedImageData}`;
                        overlayCanvas.style.display = 'none';
                        break;
                }
            }
        }

        // Send report to server
        async function sendReport() {
            const notes = reportNotes.value.trim();
            const location = reportLocation.value.trim();
            const priority = reportPriority.value;
            
            const payload = {
                detections: currentDetections,
                notes: notes,
                location: location,
                priority: priority,
                timestamp: new Date().toISOString(),
                user: currentUser
            };

            try {
                const response = await fetch('http://localhost:5000/send_report', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                const data = await response.json();
                if (data.status === 'sent') {
                    showSuccess('Report sent successfully!');
                    reportNotes.value = '';
                    reportLocation.value = '';
                    reportPriority.value = 'low';
                } else {
                    throw new Error(data.error || 'Unknown error');
                }
            } catch (err) {
                showError(`Report failed: ${err.message}`);
            }
        }

        // Save report locally
        function saveReport() {
            const reportData = {
                detections: currentDetections,
                timestamp: new Date().toISOString(),
                user: currentUser,
                image: resultImage.src
            };
            
            const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(reportData));
            const downloadAnchorNode = document.createElement('a');
            downloadAnchorNode.setAttribute("href", dataStr);
            downloadAnchorNode.setAttribute("download", "hazard_report_" + new Date().toISOString().slice(0, 10) + ".json");
            document.body.appendChild(downloadAnchorNode);
            downloadAnchorNode.click();
            downloadAnchorNode.remove();
            
            showSuccess('Report saved successfully!');
        }

        // Populate recent detections on dashboard
        function populateRecentDetections() {
            const sampleDetections = [
                { type: 'Pothole', severity: 'high', location: 'Main St & 5th Ave', time: '2 hours ago', confidence: 92 },
                { type: 'Stalled Vehicle', severity: 'medium', location: 'Highway 101, Exit 42', time: '5 hours ago', confidence: 87 },
                { type: 'Debris', severity: 'low', location: 'Oak Street', time: '1 day ago', confidence: 78 },
                { type: 'Speed Breaker', severity: 'medium', location: 'School Zone, Elm St', time: '2 days ago', confidence: 82 }
            ];
            
            recentDetections.innerHTML = '';
            
            sampleDetections.forEach(det => {
                const detectionEl = document.createElement('div');
                detectionEl.className = 'detection-item ' + det.severity;
                detectionEl.innerHTML = `
                    <div class="detection-header">
                        <div class="detection-type">${det.type}</div>
                        <div class="detection-confidence">${det.confidence}%</div>
                    </div>
                    <div class="detection-bbox">Location: ${det.location}</div>
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div class="detection-severity severity-${det.severity}">${det.severity.toUpperCase()}</div>
                        <div style="font-size: 12px; color: var(--text-muted);">${det.time}</div>
                    </div>
                `;
                recentDetections.appendChild(detectionEl);
            });
        }

        // Initialize hazard map with sample data
        function initializeHazardMap() {
            // Add sample hazard points to the map
            const hazards = [
                { x: 30, y: 40, severity: 'high' },
                { x: 70, y: 60, severity: 'medium' },
                { x: 50, y: 80, severity: 'low' },
                { x: 80, y: 30, severity: 'high' },
                { x: 20, y: 70, severity: 'medium' },
                { x: 60, y: 20, severity: 'low' },
                { x: 40, y: 50, severity: 'high' }
            ];
            
            hazards.forEach(hazard => {
                const point = document.createElement('div');
                point.className = `map-point point-${hazard.severity}`;
                point.style.left = `${hazard.x}%`;
                point.style.top = `${hazard.y}%`;
                hazardMap.appendChild(point);
            });
        }

        // UI Helper Functions
        function showLoading() {
            loading.style.display = 'flex';
        }

        function hideLoading() {
            loading.style.display = 'none';
        }

        function showDemoLoading() {
            demoLoading.style.display = 'flex';
        }

        function hideDemoLoading() {
            demoLoading.style.display = 'none';
        }

        function showResults() {
            results.style.display = 'block';
            results.classList.add('fade-in');
        }

        function hideResults() {
            results.style.display = 'none';
        }

        function showError(message) {
            error.querySelector('#errorText').textContent = message;
            error.style.display = 'flex';
        }

        function hideError() {
            error.style.display = 'none';
        }

        function showDemoError(message) {
            demoError.querySelector('#demoErrorText').textContent = message;
            demoError.style.display = 'flex';
        }

        function hideDemoError() {
            demoError.style.display = 'none';
        }

        function showSuccess(message) {
            successMsg.querySelector('span').textContent = message;
            successMsg.style.display = 'flex';
            setTimeout(() => {
                successMsg.style.display = 'none';
            }, 3000);
        }
    </script>
</body>
</html>